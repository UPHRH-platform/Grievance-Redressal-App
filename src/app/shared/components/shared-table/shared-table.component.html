<div>

  <table
    class="m4"
    mat-table
    [dataSource]="dataSource"
    class="mat-elevation-z1"
    matSort
    (matSortChange)="onSortChange($event)"
    sortActionDescription="Sort by number"
  >
    <ng-container
      matColumnDef="position"
      *ngFor="let disCol of tableColumns; let colIndex = index"
      matColumnDef="{{ disCol.columnDef }}"
    >
      <!-- if sortable column header -->
      <ng-container *ngIf="disCol.isSortable; else notSortable">
        <th mat-header-cell *matHeaderCellDef mat-sort-header [ngStyle]="disCol?.cellStyle">
          {{ disCol.header }}
        </th>
      </ng-container>
      <!-- else not sortable -->
      <ng-template #notSortable>
        <th mat-header-cell *matHeaderCellDef [ngStyle]="disCol?.cellStyle">
          {{ disCol.header }}
        </th>
      </ng-template>

      <td
        mat-cell
        *matCellDef="let element; let rowIndex = index;"
        [id]="rowAction"
        (click)="emitRowAction(element)"
      >
        <span *ngIf="!disCol.isAction; else action">
          <a *ngIf="disCol.colType !== 'SerNo'; else serNo">{{ disCol.cell(element) }}</a>
          <ng-template #serNo>
            {{rowIndex + 1}}
          </ng-template>
        </span>

        <ng-template #action>
          <ng-container *ngIf="!disCol.isButton; else buttons">
            <a mat-button (click)="emitCellClickAction(element, disCol?.columnDef)">{{ disCol.cell(element) }}</a>
          </ng-container>
          <ng-template #buttons>
            <ng-container [ngSwitch]="disCol.buttonType">
              <ng-container *ngSwitchCase="'delete'">
                <button mat-button [id]="rowActionIcon" (click)="emitCellClickAction(element, 'delete')">
                  <mat-icon class="deleteClass">delete</mat-icon>
                </button>
              </ng-container>
              <ng-container *ngSwitchCase="'edit'">
                <button mat-button [id]="rowActionIcon" (click)="emitCellClickAction(element, 'edit')">
                  <mat-icon class="editClass">edit</mat-icon>
                </button>
              </ng-container>
              <ng-container *ngSwitchCase="'editCell'">
                <ng-container *ngIf="!element.isEdit; else editCell">
                  <a>{{ disCol.cell(element) }}</a>
                  <button mat-button [id]="rowActionIcon" (click)="element.isEdit = true">
                    <mat-icon class="editClass">edit</mat-icon>
                  </button>
                </ng-container>
                <ng-template #editCell>
                  <div class="flex editCell">
                    <mat-form-field appearance="outline" class="eiditableText">
                      <input matInput required type="text" [(ngModel)]="element[disCol.columnDef]" />
                    </mat-form-field>
                    <button mat-raised-button color="primary" class="doneBtn" (click)="editRow(element)">
                      Done
                    </button>
                  </div>
                </ng-template>
              </ng-container>
              <ng-container *ngSwitchCase="'slideToggle'">
                <mat-slide-toggle class="slideToggle" [checked]="element[disCol.columnDef]" (change)="editRow(element)">
                </mat-slide-toggle>
              </ng-container>
              <ng-container *ngSwitchDefault>
                <button mat-button [id]="rowActionIcon" (click)="emitCellClickAction(element, 'default')">
                  <mat-icon>delete</mat-icon>
                </button>
              </ng-container>
            </ng-container>
          </ng-template>
        </ng-template>
        <span *ngIf="disCol.isMenuOption">
          <button
            mat-icon-button
            [matMenuTriggerFor]="menu"
            aria-label="Example icon-button with a menu"
          >
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="onClickEdit(element)">
              <mat-icon>edit</mat-icon>
              <span>Edit</span>
            </button>
            <button mat-menu-item>
              <mat-slide-toggle
                (change)="onToggleChange(element)"
                [color]="primary"
                [checked]="!element.isActive"
              >
                Deactivate
              </mat-slide-toggle>
            </button>
            <!-- <button mat-menu-item (click)="onClickDelete(element)">
                            <mat-icon>delete</mat-icon>
                            <span>Delete</span> 
                         </button> -->
          </mat-menu>
        </span>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>

  <mat-paginator
    *ngIf="isPageable && !isServerSidePagination"
    [pageSizeOptions]="[10, 20, 50]"
    showFirstLastButtons
    aria-label="Select page.."
  >
  </mat-paginator>
  <mat-paginator
    #paginator
    *ngIf="isPageable && isServerSidePagination"
    (page)="handlePageEvent($event)"
    [length]="length"
    [pageSize]="pageSize"
    [disabled]="disabled"
    [showFirstLastButtons]="showFirstLastButtons"
    [pageSizeOptions]="showPageSizeOptions ? [10, 20, 50] : []"
    [hidePageSize]="hidePageSize"
    [pageIndex]="pageIndex"
    aria-label="Select page1"
  >
  </mat-paginator>
</div>
